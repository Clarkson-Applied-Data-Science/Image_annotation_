{% extends "base.html" %}
{% block content %}
<section class="card">
<h2>Search & Edit</h2>

<form method="POST">
    <input type="text" name="query" class="form-control" 
           placeholder="Search label, description, project, image..."
           value="{{ query }}">
    <button class="btn btn-primary" style="margin-top:10px;">Search</button>
</form>

<br>

{% if results %}
    <table class="table table-bordered">
        <tr>
            <th>Label</th>
            <th>Description</th>
            <th>Project</th>
            <th>Image</th>
            <th>User</th>
            <!--<th>Action</th>-->
        </tr>

        {% for r in results %}
        <tr>
            <td>{{ r.L_Name }}</td>
            <td>{{ r.Description }}</td>
            <td>{{ r.Project_name }}</td>

            <!--  IMAGE PREVIEW ADDED HERE  -->
            <td>
                <img src="/{{ r.Image_path }}" 
                     style="width:120px; height:auto; border:1px solid #ccc; cursor:pointer;"
                     onclick="openImage('{{ r.Image_path }}')">
            </td>

            <td>{{ r.user_name }}</td>

           <!-- <td>
                {% if me.role == 'admin' or me.UID == r.UID %}
                    <a href="/labels/edit/{{ r.Label_ID }}">Edit Label</a>
                {% endif %}

                {% if me.role == 'admin' %}
                    | <a href="/projects/edit/{{ r.Project_ID }}">Edit Project</a>
                {% endif %}
            </td>-->
        </tr>
        {% endfor %}
    </table>
{% else %}
    {% if query %}
        <p>No results found.</p>
    {% endif %}
{% endif %}

<!--  POPUP IMAGE VIEWER  -->
<script>
function openImage(path) {
    const w = window.open("", "_blank");
    w.document.write(`<img src="/${path}" style="width:100%;">`);
}
</script>
</section>
{% endblock %}
